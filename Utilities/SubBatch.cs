using System;
using System.Collections.Generic;

namespace Utilities
{
    [Serializable]
    public class SubBatch   // sent from global coordinator to local coordinator
    {
        public readonly long bid;
        public readonly int coordID;

        public long lastBid;
        public List<long> txnList;

        // NOTICE: this field is only used for batches generated by local coordinators
        public long lastGlobalBid;

        public SubBatch(long bid, int coordID)
        {
            lastBid = -1;
            this.bid = bid;
            this.coordID = coordID;
            txnList = new List<long>();
            lastGlobalBid = -1;
        }

        public SubBatch(SubBatch subBatch)
        {
            bid = subBatch.bid;
            coordID = subBatch.coordID;
            lastBid = subBatch.lastBid;
            txnList = subBatch.txnList;
            lastGlobalBid = subBatch.lastGlobalBid;
        }
    }

    [Serializable]
    public class LocalSubBatch : SubBatch     // sent from local coordinator to transactional grains
    {
        public readonly long globalBid;
        public Dictionary<long, long> globalTidToLocalTid;

        public long highestCommittedBid;

        public LocalSubBatch(long globalBid, SubBatch subBatch) : base(subBatch)
        {
            this.globalBid = globalBid;
            globalTidToLocalTid = new Dictionary<long, long>();
            highestCommittedBid = -1;
        }
    }
}